(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{95:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(28),s=a.n(r),o=(a(67),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,109)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))}),i=a(18),l=a(10),u=a(8),j=a.n(u),d=a(13),h=a(19),b=a(9),p=a(7),O=a(100),x=a(104),f=a(107),m=a(61),g=a(1),v=c.a.createContext(),w=c.a.createContext();function N(){return Object(n.useContext)(v)}function y(){return Object(n.useContext)(w)}function S(e){var t=e.children,a=Object(n.useState)(null!==localStorage.getItem("torch_at")),c=Object(p.a)(a,2),r=c[0],s=c[1];return Object(g.jsx)(v.Provider,{value:r,children:Object(g.jsx)(w.Provider,{value:s,children:t})})}var C={headers:{"Content-Type":"application/json"}},k=function(e){return{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}};function _(){var e=a(25),t=Object(l.f)();N()&&t.push("/");var c=Object(n.useState)({username:"",password:"",password2:""}),r=Object(p.a)(c,2),s=r[0],o=r[1],i=Object(n.useState)({show:!1,error:[]}),u=Object(p.a)(i,2),v=u[0],w=u[1];function y(e){var t=e.currentTarget,a=t.id,n=t.value;o(Object(b.a)(Object(b.a)({},s),{},Object(h.a)({},a,n)))}var S=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),s.password===s.password2){a.next=6;break}o(Object(b.a)(Object(b.a)({},s),{},{password:"",password2:""})),w({show:!0,error:["Passwords must match"]}),a.next=9;break;case 6:return delete s.password2,a.next=9,e.post("/api/signup",JSON.stringify(s),C).then((function(e){w({status:!1,error:[]}),t.push("/login")})).catch((function(e){o(Object(b.a)(Object(b.a)({},s),{},{password:"",password2:""})),console.log(e),null!==e.response.status&&400===e.response.status&&w({show:!0,error:void 0!==e.response.data.username?["Username taken."]:e.response.data.password})}));case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(g.jsx)(O.a,{className:"d-flex p-2 justify-content-center text-center",children:Object(g.jsxs)(x.a,{onSubmit:S,children:[Object(g.jsx)(x.a.Row,{className:"p-4",style:{backgroundColor:"darkblue",borderRadius:"20px 50px",color:"white"},children:Object(g.jsx)("h2",{children:"Signup"})}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Username:"}),Object(g.jsx)(x.a.Control,{id:"username",type:"text",value:s.username,onChange:y,required:!0})]}),Object(g.jsx)(x.a.Text,{children:"Username cannot be changed later"}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Password:"}),Object(g.jsx)(x.a.Control,{id:"password",type:"password",value:s.password,onChange:y,required:!0})]}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Confirm Password:"}),Object(g.jsx)(x.a.Control,{id:"password2",type:"password",value:s.password2,onChange:y,required:!0})]}),!0===v.show&&Object(g.jsx)(f.a,{variant:"danger",children:v.error.map((function(e){return Object(g.jsx)("div",{children:e})}))}),Object(g.jsx)(m.a,{type:"submit",className:"m-2",variant:"outline-success",children:"Signup"}),Object(g.jsxs)(f.a,{variant:"warning",style:{borderRadius:"20px 50px"},children:["Already have an account?",Object(g.jsx)(m.a,{href:"/login",variant:"link",children:"Login"})]})]})})}function I(){var e=a(25),t=Object(l.f)(),c=Object(n.useState)({username:"",password:""}),r=Object(p.a)(c,2),s=r[0],o=r[1],i=Object(n.useState)({show:!1,error:""}),u=Object(p.a)(i,2),v=u[0],w=u[1],S=N(),_=y();S&&t.push("/");var I=function(e){var t=e.currentTarget,a=t.id,n=t.value;o(Object(b.a)(Object(b.a)({},s),{},Object(h.a)({},a,n)))},L=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,e.post("/api/token/obtain",JSON.stringify(s),C).then((function(t){return localStorage.setItem("torch_at",t.data.access),localStorage.setItem("torch_rt",t.data.refresh),e.get("/api/".concat(s.username),k(localStorage.getItem("torch_at")))})).then((function(e){localStorage.setItem("torch_user_data",JSON.stringify(e.data)),_(!0),w({status:!1,error:[]}),t.push("/")})).catch((function(e){console.log(e),w({show:!0,error:void 0!==e.response?e.response.data:e}),o(Object(b.a)(Object(b.a)({},s),{},{password:""})),t.push("/login")}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(g.jsx)(O.a,{className:"d-flex pt-2 justify-content-center text-center",children:Object(g.jsxs)(x.a,{onSubmit:L,children:[Object(g.jsx)(x.a.Row,{className:"p-4",style:{backgroundColor:"darkblue",borderRadius:"20px 50px",color:"white"},children:Object(g.jsx)("h2",{children:"Login"})}),Object(g.jsx)("br",{}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Username:"}),Object(g.jsx)(x.a.Control,{id:"username",type:"text",value:s.username,onChange:I,required:!0})]}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Password:"}),Object(g.jsx)(x.a.Control,{id:"password",type:"password",value:s.password,onChange:I,required:!0})]}),!0===v.show&&Object(g.jsx)(f.a,{variant:"danger",children:v.error.detail}),Object(g.jsx)(m.a,{type:"submit",className:"m-2",variant:"outline-success",style:{borderWidth:"3px"},children:"Login"}),Object(g.jsxs)(f.a,{variant:"warning",style:{borderRadius:"20px 50px"},children:["Don't have an account?",Object(g.jsx)(m.a,{href:"/signup",variant:"link",children:"Signup"})]})]})})}function L(){var e=a(25),t=Object(l.f)(),n=Object(l.h)().username;null===n&&t.goBack();var c=y(),r=function(){var a=Object(d.a)(j.a.mark((function a(){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.delete("/api/".concat(n),k(localStorage.getItem("torch_at"))).then((function(){["torch_at","torch_rt","torch_user_data"].map((function(e){return localStorage.removeItem(e)})),c(!1),alert("Account deleted."),t.push("/")})).catch((function(e){alert(e),console.log(e)}));case 2:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return Object(g.jsxs)(f.a,{variant:"danger",className:"m-5 text-center",children:["Account will be deleted immediately and cannot be recovered!",Object(g.jsx)("p",{children:"Are you sure?"}),Object(g.jsx)("p",{children:Object(g.jsx)(m.a,{variant:"danger",onClick:r,children:"DELETE"})})]})}function P(){var e=a(25),t=Object(l.f)(),c=Object(l.h)().username,r=Object(n.useState)({old_password:"",password:"",password2:""}),s=Object(p.a)(r,2),o=s[0],i=s[1],u=Object(n.useState)({show:!1,error:{}}),v=Object(p.a)(u,2),w=v[0],N=v[1],y=function(e){var t=e.currentTarget,a=t.id,n=t.value;i(Object(b.a)(Object(b.a)({},o),{},Object(h.a)({},a,n)))},S=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),o.password===o.password2){a.next=6;break}i(Object(b.a)(Object(b.a)({},o),{},{password:"",password2:""})),alert("Passwords must match"),a.next=9;break;case 6:return delete o.password2,a.next=9,e.put("/api/".concat(c,"/change-password"),o,k(localStorage.getItem("torch_at"))).then((function(){alert("Password Updated"),t.push("/")})).catch((function(e){N({show:!0,error:null!==e.response.data.password?e.response.data.password:["Unknown error occured"]}),console.log(e)}));case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(g.jsx)(O.a,{className:"d-flex p-2 justify-content-center text-center",children:Object(g.jsxs)(x.a,{onSubmit:S,children:[Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Old Password:"}),Object(g.jsx)(x.a.Control,{id:"old_password",type:"password",value:o.old_password,onChange:y,required:!0})]}),Object(g.jsxs)(x.a.Group,{className:"p-2",children:[Object(g.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"New Password:"}),Object(g.jsx)(x.a.Control,{id:"password",type:"password",value:o.password,onChange:y,required:!0})]}),w.show&&Object(g.jsx)("div",{className:"d-flex justify-content-end",children:Object(g.jsx)(f.a,{variant:"danger",children:w.error.map((function(e){return Object(g.jsx)("div",{children:e})}))})})]}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Confirm Password:"}),Object(g.jsx)(x.a.Control,{id:"password2",type:"password",value:o.password2,onChange:y,required:!0})]}),Object(g.jsx)(m.a,{type:"submit",className:"m-2",variant:"outline-danger",children:"Save Password"})]})})}var q=a(101),T=a(108);function J(e){var t=e.post,a=e.isAuthor,n=Object(l.f)(),c=function(e){n.push({pathname:e,state:{post:t}})};return Object(g.jsxs)(T.a,{className:"m-3",style:{backgroundColor:"lightsteelblue",border:"3px solid darkblue"},children:[Object(g.jsxs)(T.a.Header,{children:[Object(g.jsx)("h1",{children:t.title}),!0===a&&Object(g.jsx)("span",{children:Object(g.jsx)(m.a,{id:"edit",onClick:function(){return c("/p/".concat(t.slug,"/edit"))},children:"Edit"})}),Object(g.jsxs)("div",{className:"",children:["last edited: ",t.modified]}),Object(g.jsx)(T.a.Subtitle,{className:"text-muted",children:Object(g.jsx)("footer",{id:"author",className:"blockquote-footer d-flex justify-content-end",children:Object(g.jsxs)("cite",{onClick:function(){return n.push("/".concat(t.author))},style:{cursor:"pointer"},children:["Author: ",t.author]})})})]}),Object(g.jsx)(T.a.Body,{onClick:function(){return c("/p/".concat(t.slug))},style:{width:"98%",cursor:"pointer"},children:Object(g.jsx)("blockquote",{className:"blockquote",children:t.content.length>50?t.content.substr(0,50)+"...":t.content})})]})}function D(){var e=a(25),t=Object(n.useState)([]),c=Object(p.a)(t,2),r=c[0],s=c[1],o=Object(n.useState)(!0),i=Object(p.a)(o,2),l=i[0],u=i[1];return Object(n.useEffect)((function(){e.get("/api/p").then((function(e){s(e.data),u(!1)})).catch((function(e){console.log(e)}))}),[r]),l?Object(g.jsx)(q.a,{animation:"border",variant:"primary",className:"m-5"}):0===r.length?Object(g.jsx)(f.a,{variant:"danger",className:"m-4 text-center",children:Object(g.jsx)(f.a.Heading,{children:"Nothing blogs to show!"})}):Object(g.jsx)(O.a,{className:"justify-content-center",children:r.map((function(e){return Object(g.jsx)(J,{post:e,isAuthor:!1})}))})}var A=a(105),G=a(106),E=a(103);function B(){var e=Object(l.f)(),t=N(),a=y();return Object(g.jsxs)(A.a,{variant:"dark",bg:"dark",children:[Object(g.jsx)(A.a.Brand,{className:"p-3 m-3",style:{border:"2px solid cyan",borderRadius:"50px 20px"},children:Object(g.jsx)("h2",{children:"DR Blog"})}),Object(g.jsxs)(G.a,{style:{width:"65%"},className:"d-flex justify-content-center p-2",children:[Object(g.jsx)(G.a.Item,{children:Object(g.jsx)(G.a.Link,{href:"/",children:"Home"})}),!t&&Object(g.jsx)(G.a.Item,{children:Object(g.jsx)(G.a.Link,{href:"/signup",children:"Signup"})}),!t&&Object(g.jsx)(G.a.Item,{children:Object(g.jsx)(G.a.Link,{href:"/login",children:"Login"})}),t&&Object(g.jsx)(G.a.Item,{children:Object(g.jsx)(G.a.Link,{href:"/".concat(JSON.parse(localStorage.getItem("torch_user_data")).username),children:"My Posts"})}),t&&Object(g.jsx)(E.a,{title:"Account",children:[{name:"Change Password",href:"/change-password"},{name:"Delete Account",href:"/confirm-delete"}].map((function(e){return Object(g.jsx)(E.a.Item,{href:"/".concat(JSON.parse(localStorage.getItem("torch_user_data")).username).concat(e.href),children:e.name})}))})]}),t&&Object(g.jsxs)(G.a,{className:"d-flex justify-content-end",children:[Object(g.jsxs)(A.a.Brand,{className:"m-2",style:{color:"cyan"},children:["Hello"," ",JSON.parse(localStorage.getItem("torch_user_data")).username,"!"]}),Object(g.jsx)(m.a,{href:"/p/create",variant:"outline-info",className:"m-2",children:"Create New Post"}),Object(g.jsx)(m.a,{onClick:function(){["torch_at","torch_rt","torch_user_data"].map((function(e){return localStorage.removeItem(e)})),a(!1),e.push("/")},variant:"outline-info",className:"m-2",children:"Logout"})]})]})}function R(){var e=a(25),t=Object(l.f)(),c=Object(l.h)().username,r=Object(n.useState)([]),s=Object(p.a)(r,2),o=s[0],i=s[1],u=Object(n.useState)(!0),j=Object(p.a)(u,2),d=j[0],h=j[1],b=!!N()&&c===JSON.parse(localStorage.getItem("torch_user_data")).username;return Object(n.useEffect)((function(){e.get("/api/".concat(c,"/p"),C).then((function(e){i(e.data),console.log(e.data),h(!1)})).catch((function(e){404===e.response.status&&alert("No such author exists"),t.goBack(),console.log(e)}))}),[o]),d?Object(g.jsx)(q.a,{animation:"border",variant:"primary"}):0===o.length?Object(g.jsxs)(f.a,{variant:"danger",className:"m-4 text-center",children:[Object(g.jsx)(f.a.Heading,{children:"Nothing blogs to show!"}),Object(g.jsx)("p",{children:"Try clicking on Create New Post!"})]}):Object(g.jsxs)(O.a,{className:"m-1",children:[Object(g.jsxs)("h2",{className:"m-2",children:[c,"'s blogs"]}),o.map((function(e){return Object(g.jsx)(J,{post:e,isAuthor:b})}))]})}var U=a(102);function H(){var e=a(25),t=Object(l.f)(),c=Object(l.g)(),r=Object(l.h)().slug,s=Object(n.useState)({}),o=Object(p.a)(s,2),i=o[0],u=o[1],h=Object(n.useState)(!1),b=Object(p.a)(h,2),O=b[0],x=b[1],f=N();Object(n.useEffect)((function(){var t=function(){var t=Object(d.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("/api/p/".concat(r)).then((function(e){u(e.data)})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();void 0!==c.state?u(c.state.post):t(),f&&x(i.author===JSON.parse(localStorage.getItem("torch_user_data")).username)}),[]);return Object(g.jsxs)(U.a,{fluid:!0,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:Object(g.jsx)("p",{children:i.title})}),!0===O&&Object(g.jsx)(m.a,{onClick:function(){t.push({pathname:"/p/".concat(r,"/edit"),state:{post:i}})},children:"Edit"}),Object(g.jsx)("blockquote",{className:"blockquote",children:Object(g.jsxs)("footer",{className:"blockquote-footer d-flex justify-content-end",children:["Author:"," ",Object(g.jsx)("cite",{onClick:function(){return t.push("/".concat(i.author))},style:{cursor:"pointer"},children:i.author})]})}),Object(g.jsxs)("h6",{className:"d-flex justify-content-end",children:["last edited: ",i.modified]})]}),Object(g.jsx)("h5",{children:i.content})]})}function F(){var e=a(25),t=Object(l.f)(),c=Object(n.useState)({title:"",content:"",author:JSON.parse(localStorage.getItem("torch_user_data")).username}),r=Object(p.a)(c,2),s=r[0],o=r[1],i=function(e){var t=e.currentTarget,a=t.id,n=t.value;o(Object(b.a)(Object(b.a)({},s),{},Object(h.a)({},a,n)))},u=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,e.post("/api/p",JSON.stringify(s),k(localStorage.getItem("torch_at"))).then((function(){alert("Post successful"),t.push("/".concat(JSON.parse(localStorage.getItem("torch_user_data")).username))})).catch((function(e){return console.log(e)}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(g.jsx)(O.a,{className:"d-flex p-2 text-center",style:{width:"95%"},children:Object(g.jsxs)(x.a,{onSubmit:u,children:[Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Title:"}),Object(g.jsx)(x.a.Control,{id:"title",type:"text",value:s.title,onChange:i,required:!0})]}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Content:"}),Object(g.jsx)(x.a.Control,{id:"content",as:"textarea",value:s.content,onChange:i,required:!0})]}),Object(g.jsx)(m.a,{type:"submit",className:"m-2",variant:"outline-success",children:"Create Post"})]})})}function M(){var e=a(25),t=Object(l.f)(),c=Object(l.h)().slug,r=Object(l.g)(),s=Object(n.useState)(r.state.post),o=Object(p.a)(s,2),i=o[0],u=o[1],f=Object(n.useState)({content:i.content}),v=Object(p.a)(f,2),w=v[0],y=v[1],S=N(),C=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,e.put("/api/p/".concat(c,"/edit"),JSON.stringify(w),k(localStorage.getItem("torch_at"))).then((function(){alert("Edited Successfully!"),t.push("/p/".concat(c))})).catch((function(e){return console.log(e)}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),_=function(){var a=Object(d.a)(j.a.mark((function a(n){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,e.delete("/api/p/".concat(c),k(localStorage.getItem("torch_at"))).then((function(){alert("Deleted Successfully"),t.push("/".concat(i.author))})).catch((function(e){return console.log(e)}));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(n.useEffect)((function(){var a=function(){var t=Object(d.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("/api/p/".concat(c)).then((function(e){u(e.data)})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();void 0!==r.state?u(r.state.post):a(),S?i.author!==JSON.parse(localStorage.getItem("torch_user_data")).username&&(alert("You can only edit your own blog posts."),t.goBack()):t.push("/login")}),[]),Object(g.jsx)(O.a,{className:"d-flex p-2 text-center",style:{width:"95%"},children:Object(g.jsxs)(x.a,{children:[Object(g.jsx)("h3",{children:w.title}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Title:"}),Object(g.jsx)(x.a.Control,{id:"title",type:"text",value:i.title}),Object(g.jsx)(x.a.Text,{children:"Title once set cannot be changed"})]}),Object(g.jsxs)(x.a.Group,{className:"d-flex p-2",children:[Object(g.jsx)(x.a.Label,{className:"m-2",children:"Content:"}),Object(g.jsx)(x.a.Control,{id:"content",as:"textarea",value:w.content,onChange:function(e){var t=e.currentTarget,a=t.id,n=t.value;y(Object(b.a)(Object(b.a)({},w),{},Object(h.a)({},a,n)))}})]}),Object(g.jsx)(m.a,{onClick:C,className:"m-2",variant:"outline-warning",children:"Save Changes"}),Object(g.jsx)(m.a,{onClick:_,className:"m-2",variant:"danger",children:"Delete Post"})]})})}var z=function(){return Object(g.jsx)(S,{children:Object(g.jsxs)(i.a,{children:[Object(g.jsx)(B,{}),Object(g.jsxs)(l.c,{children:[Object(g.jsx)(l.a,{exact:!0,path:"/",component:D}),Object(g.jsx)(l.a,{exact:!0,path:"/login",component:I}),Object(g.jsx)(l.a,{exact:!0,path:"/signup",component:_}),Object(g.jsx)(l.a,{exact:!0,path:"/:username",component:R}),Object(g.jsx)(l.a,{exact:!0,path:"/p/create",component:F}),Object(g.jsx)(l.a,{exact:!0,path:"/:username/confirm-delete",component:L}),Object(g.jsx)(l.a,{exact:!0,path:"/p/:slug",component:H}),Object(g.jsx)(l.a,{exact:!0,path:"/p/:slug/edit",component:M}),Object(g.jsx)(l.a,{exact:!0,path:"/:username/change-password",component:P}),Object(g.jsx)(l.a,{path:"*",children:Object(g.jsx)("h1",{children:"404 Not found"})})]})]})})};s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(z,{})}),document.getElementById("root")),o()}},[[95,1,2]]]);
//# sourceMappingURL=main.0aef93c5.chunk.js.map